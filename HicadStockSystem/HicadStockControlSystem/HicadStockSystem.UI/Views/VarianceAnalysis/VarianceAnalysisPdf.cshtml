@model  HicadStockSystem.Core.Utilities.ReportVM
@using Microsoft.AspNetCore.Http;
@{
	ViewBag.Title = "VarianceAnalysisPdf";
}
@{
	Layout = null;

}
<!DOCTYPE html>
<html>
<body>
	 <h1 style="text-align:center" class="text-center display-4">@Model.StkSystems.CompanyName</h1>
	 <h3 style="text-align:center">@Model.StkSystems.CompanyAddress</h3>

	 <br />
	@*<h3 style="text-align:center">REPORTS</h3>
		<h4 style="text-align:center">Stock Position</h4>*@

	 <h3>Variance Analysis: Produce On @DateTime.Now</h3>
	 <table border="2" cellpadding="2" cellspacing="0" width="100%">
		  <tr style="text-align:center">
			   <th>Item Code</th>
			   <th>Item Description</th>
			   <th>Open Balance</th>
			   <th>Physical Count</th>
			   <th>Quantity(Variance)</th>
			   <th>Stock Price</th>
			   <th>Value</th>
		  </tr>
			@foreach (var a in Model.VarianceAnalyses)
			{
			  <tr style="text-align:center">
			   <td> @a.ItemCode </td>
			   <td> @a.ItemDesc </td>
			   <td> @a.OpenBalance </td>
			   <td> @a.PhysicalCount </td>
			   <td> @a.Quantity</td>
			   <td> @Math.Round((decimal)(a.StockPrice),2) </td>
			   <td> @Math.Round((decimal)(a.Value),2) </td>
			  </tr>
			}

		  <tr>

			   <td><span><b>Total</b></span></td>
			   <td></td>
			   <td></td>
			   <td></td>
			   <td></td>
			   <td></td>
			   <td style="text-align:center"><span><b>@Math.Round((decimal)Model.VarianceAnalyses.ToList().Sum(x=>x.Value),2
		   )</b></span></td>
		  </tr>

	 </table>

</body>
</html>
